---
title: 'How to deploy Docker on a server using ansible'
date: '03-12-2025'
summary: 'This guide walks you through deploying Docker on a server using Ansible, focusing on efficiency, automation, and Infrastructure as Code (IaC).'
tags: ['Docker', 'Ansible', 'Automation', 'IaC', 'Ubuntu', 'Linux', 'Server Deployment']
draft: 'true'
authors: ['default']
---

<div align="justify">

Are you tired of manual Docker installations and looking for a reliable way to automate the deployment process? With Docker's popularity skyrocketing, knowing how to deploy it effectively is crucial for modern DevOps practices. This guide explores the seamless integration of Ansible and Docker, leveraging Infrastructure as Code (IaC) principles to ensure a smooth deployment process. Let’s dive in!

</div>
---

<div align="justify">

### Understanding Prerequisites
Before we start, we'll need a few prerequisites in place:

1. A server running Ubuntu 20.04 or similar.
2. Ansible installed and configured on your control machine. You can install Ansible on your local machine or on a dedicated administrative node.
3. SSH access to the target server where Docker will be installed.

### Step 1: Installing Ansible
To install Ansible on your control machine, you can use the following commands:
```shell
sudo apt update
sudo apt install ansible -y
```

After successful installation, check the Ansible version using:
```shell
ansible --version
```
Expected output:
```
ansible 2.x.x
```

### Step 2: Setting up the Inventory
Ansible requires an inventory file to identify which servers to configure. Create a file named `hosts.ini`:
```ini
[docker_hosts]
your_server_ip ansible_ssh_user=your_username
```
Replace `your_server_ip` with your actual server's IP address and `your_username` with the SSH username.

### Step 3: Creating the Ansible Playbook
Ansible uses playbooks to define the actions that need to be performed. Create a file named `docker_install.yml`:
```yaml
---
- hosts: docker_hosts
  become: true
  tasks:
    - name: Update apt apt cache if the cache is older than 1 day
      apt:
        update_cache: yes
        cache_valid_time: 86400

    - name: Install required packages
      apt:
        name:
          - apt-transport-https
          - ca-certificates
          - curl
          - software-properties-common
        state: present

    - name: Add Docker’s official GPG key
      command: curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

    - name: Set up the stable repository
      apt_repository:
        repo: "deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_lsb.codename }} stable"

    - name: Install Docker CE
      apt:
        name: docker-ce
        state: latest

    - name: Start and enable Docker
      service:
        name: docker
        state: started
        enabled: yes
```
This playbook will update the server's package index, install the required packages, add Docker's official GPG key, set up the repository, and finally install Docker CE.

### Step 4: Execute the Playbook
To apply your playbook, run the following command:
```shell
ansible-playbook -i hosts.ini docker_install.yml
```
Watch the output to ensure that all tasks were completed successfully. Expected successful output should look like:
```
PLAY [docker_hosts] ****************************************************************
TASK [Update apt apt cache if the cache is older than 1 day] **********************

TASK [Install required packages] **************************************************

TASK [Add Docker’s official GPG key] ***********************************************

TASK [Set up the stable repository] ***********************************************

TASK [Install Docker CE] *********************************************************

TASK [Start and enable Docker] ****************************************************
...

PLAY RECAP ***********************************************************************
your_server_ip               : ok=6    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

### Troubleshooting Common Issues
While deploying, you might encounter several issues. Here are some common ones:
- **Permission Denied**: Ensure you have sudo privileges on the target server.
- **Docker installation fails**: Ensure your server has internet access and that you are using the correct Ubuntu release.
- **Service not starting**: Check Docker service status with `systemctl status docker` to see the logs for any errors.

### Conclusion
Automating Docker deployment with Ansible not only saves time but also ensures a consistent environment across multiple server instances. By utilizing Infrastructure as Code principles, you can manage your Docker installations with precision and efficiency. By following this guide, you should now be able to deploy Docker on your Ubuntu server using Ansible with ease. Happy Deploying!

</div>